<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß</h2>
  <button onclick="reserve()">‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß</button>
  <p id="result"></p>

<script>
const liffId = "LIFF_ID_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì";
const apiUrl = "WEB_APP_URL_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì";

window.onload = async () => {
  await liff.init({ liffId });
};

async function reserve() {
  const profile = await liff.getProfile();

  const res = await fetch(apiUrl, {
    method: "POST",
    body: JSON.stringify({
      userId: profile.userId,
      name: profile.displayName
    })
  });

  const data = await res.json();

  if (data.status === "exists") {
    document.getElementById("result").innerText =
      `‡∏Ñ‡∏∏‡∏ì‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß\n‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà ${data.queue}\n‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å ${data.remaining} ‡∏Ñ‡∏¥‡∏ß`;
  } else {
    document.getElementById("result").innerText =
      `‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üéâ\n‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà ${data.queue}`;
  }
}
</script>
</body>
</html>
